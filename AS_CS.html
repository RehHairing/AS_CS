


<label>Name:</label><input type="text" name="attr_character_name" />

<div class="3colrow">
    <div class="col">
    <h2>Cursed Energy</h2>
        <p>d4 <input type="number" name="attr_d_4_CE" value=0 min="0" max="5">
        d6 <input type="number" name="attr_d_6_CE" value=1 min="0" max="5">
        d10 <input type="number" name="attr_d_10_CE" value=0 min="0" max="5">
        d12 <input type="number" name="attr_d_12_CE" value=0 min="0" max="5">
        d20 <input type="number" name="attr_d_20_CE" value=0 min="0" max="5"></p>
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_name}}} {{result=[[@{d_4_CE}d4 + @{d_6_CE}d6 + @{d_10_CE}d10 + @{d_12_CE}d12 + @{d_20_CE}d20]]}}'></button>
</div>
</div>

<div class="dice_pool_CON">
    <h2>Control</h2>
    <p>d4 <input type="number" name="attr_d_4_CON" value=0 min="0" max="5">
    d6 <input type="number" name="attr_d_6_CON" value=1 min="0" max="5">
    d10 <input type="number" name="attr_d_10_CON" value=0 min="0" max="5">
    d12 <input type="number" name="attr_d_12_CON" value=0 min="0" max="5">
    d20 <input type="number" name="attr_d_20_CON" value=0 min="0" max="5"></p>
    <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_name}}} {{result=[[@{d_4_CON}d4 + @{d_6_CON}d6 + @{d_10_CON}d10 + @{d_12_CON}d12 + @{d_20_CON}d20]]}}'></button>
</div>

<div class="dice_pool_BD">
    <h2>Body</h2>
    <p>d4 <input type="number" name="attr_d_4_BD" value=0 min="0" max="5">
    d6 <input type="number" name="attr_d_6_BD" value=1 min="0" max="5">
    d10 <input type="number" name="attr_d_10_BD" value=0 min="0" max="5">
    d12 <input type="number" name="attr_d_12_BD" value=0 min="0" max="5">
    d20 <input type="number" name="attr_d_20_BD" value=0 min="0" max="5"></p>
    <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_name}}} {{result=[[@{d_4_BD}d4 + @{d_6_BD}d6 + @{d_10_BD}d10 + @{d_12_BD}d12 + @{d_20_BD}d20]]}}'></button>
</div>

<div class="dice_pool_RF">
    <h2>Reflex</h2>
    <p>d4 <input type="number" name="attr_d_4_RF" value=0 min="0" max="5">
    d6 <input type="number" name="attr_d_6_RF" value=1 min="0" max="5">
    d10 <input type="number" name="attr_d_10_RF" value=0 min="0" max="5">
    d12 <input type="number" name="attr_d_12_RF" value=0 min="0" max="5">
    d20 <input type="number" name="attr_d_20_RF" value=0 min="0" max="5"></p>
    <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_name}}} {{result=[[@{d_4_RF}d4 + @{d_6_RF}d6 + @{d_10_RF}d10 + @{d_12_RF}d12 + @{d_20_RF}d20]]}}'></button>
</div>

<div class="dice_pool_INT">
    <h2>Intelligence</h2>
    <p>d4 <input type="number" name="attr_d_4_INT" value=0 min="0" max="5">
    d6 <input type="number" name="attr_d_6_INT" value=1 min="0" max="5">
    d10 <input type="number" name="attr_d_10_INT" value=0 min="0" max="5">
    d12 <input type="number" name="attr_d_12_INT" value=0 min="0" max="5">
    d20 <input type="number" name="attr_d_20_INT" value=0 min="0" max="5"></p>
    <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_name}}} {{result=[[@{d_4_INT}d4 + @{d_6_INT}d6 + @{d_10_INT}d10 + @{d_12_INT}d12 + @{d_20_INT}d20]]}}'></button>
</div>

<div class="dice_pool_SC">
    <h2>Social</h2>
    <p>d4 <input type="number" name="attr_d_4_SC" value=0 min="0" max="5">
    d6 <input type="number" name="attr_d_6_SC" value=1 min="0" max="5">
    d10 <input type="number" name="attr_d_10_SC" value=0 min="0" max="5">
    d12 <input type="number" name="attr_d_12_SC" value=0 min="0" max="5">
    d20 <input type="number" name="attr_d_20_SC" value=0 min="0" max="5"></p>
    <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_name}}} {{result=[[@{d_4_SC}d4 + @{d_6_SC}d6 + @{d_10_SC}d10 + @{d_12_SC}d12 + @{d_20_SC}d20]]}}'></button>
</div>

<div class="image-progression">
    <button type="button" name="attr_progress_backward">Previous</button>
    <img src="" name="attr_progress_image">
    <button type="button" name="attr_progress_forward">Next</button>
</div>

<script type="text/worker">
    // Array of image URLs for progression states
    const imageUrls = [
        'https://raw.githubusercontent.com/RehHairing/AS_CS/main/Images/Wounds/Wound0.JPG?token=GHSAT0AAAAAACUUQKSBFH6FJHWDAD3J567YZUNLUZQ',
        'https://raw.githubusercontent.com/RehHairing/AS_CS/main/Images/Wounds/Wound1.jpg?token=GHSAT0AAAAAACUUQKSBLGPH7IHM3D3GWAOSZUNLVTQ',
        'https://raw.githubusercontent.com/RehHairing/AS_CS/main/Images/Wounds/Wound2.jpg?token=GHSAT0AAAAAACUUQKSBVFEAI3HGSMQFEDZYZUNLV4Q',
        'https://raw.githubusercontent.com/RehHairing/AS_CS/main/Images/Wounds/Wound3.jpg?token=GHSAT0AAAAAACUUQKSA7YJJ6NVSL3B36VWYZUNL25Q',
        'https://raw.githubusercontent.com/RehHairing/AS_CS/main/Images/Wounds/Wound4.jpg?token=GHSAT0AAAAAACUUQKSBS6N2WOZDONRO2CDAZUNL36A',
        'https://raw.githubusercontent.com/RehHairing/AS_CS/main/Images/Wounds/Wound5.jpg?token=GHSAT0AAAAAACUUQKSBKW7UDC3TNJPL53CAZUNL3VA'
    ];

    // Function to update the image based on the current state
    function updateImage(state) {
        setAttrs({
            attr_progress_image: imageUrls[state]
        });
    }

    // Event listener for forward button
    on('clicked:attr_progress_forward', function() {
        getAttrs(['attr_progress_state'], function(values) {
            let state = parseInt(values.attr_progress_state, 10);
            if (state < imageUrls.length - 1) {
                state++;
                setAttrs({
                    attr_progress_state: state
                });
                updateImage(state);
            }
        });
    });

    // Event listener for backward button
    on('clicked:attr_progress_backward', function() {
        getAttrs(['attr_progress_state'], function(values) {
            let state = parseInt(values.attr_progress_state, 10);
            if (state > 0) {
                state--;
                setAttrs({
                    attr_progress_state: state
                });
                updateImage(state);
            }
        });
    });

    // Initialize the image on sheet open
    on('sheet:opened', function() {
        getAttrs(['attr_progress_state'], function(values) {
            let state = parseInt(values.attr_progress_state, 10);
            updateImage(state);
        });
    });
</script>